# 创建实例

本篇文档将为您提供注册并创建实例的详细步骤。

## 登录账号，开始创建

1. 登录您的 MO Cloud 账号，进入实例管理平台。

    如果您还没有 MO Cloud 账号，您可以点击[注册登录](https://www.matrixorigin.cn/moc-trial)开始注册，或者参照[快速体验 MatrixOne Cloud](../Get-Started/quickstart.md) 的注册指南。

2. 在菜单栏中点击**实例**进入实例列表页面，然后点击 **+创建实例**。

## 选择实例

MO Cloud 提供了两种实例类型：可自动扩缩容的 Serverless 实例和拥有独立稳定的计算资源的标准实例。点击选择您需要的实例类型后参照以下步骤进行实例的创建：

### Serveless 实例

#### 步骤一：选择公有云服务商及地区

MatrixOne Cloud 支持在阿里云创建 Serveless 实例。

| 地理区域    | 地区名 | 地点 |
| ----------- | ------ | ---- |
| 亚太 - 中国 | 华东 1 | 杭州 |

#### 步骤二：配置实例容量

##### Serveless 免费实例

选择**免费试用**，每个账户可创建 4 个免费实例，云平台会为每个实例提供免费的计算和存储资源。

!!! note
    免费实例的数据库性能稳定性无法保证，因此建议您仅用于体验或学习。对于生产应用场景，请选择**生产实例**。

当计算或存储资源用完时，实例的部分功能将受到限制，如下所示：

| 限制使用的功能 | 计算资源用完 | 存储资源用完 |
| -------------- | ------------ | ------------ |
| 数据库读操作   | 否           | 是           |
| 数据库写操作   | 否           | 否           |
| 查看实例详情   | 是           | 是           |
| 查看实例监控   | 是           | 是           |

- 计算：每个实例可使用免费 CU 为 1000 万，总共 4000 万。在您创建实例日期的一个月后会重新赠送免费的计算资源，如有剩余则不作累计。
- 存储：每个实例可使用免费存储为 50GiB。存储资源达到赠送上限后，除了可以通过删除数据的方式重新获得数据库的写操作，为了保持数据的完整性，我们更推荐您将实例转换为**Serveless 生产实例**。

通过以下方式您可以将免费实例平滑转换为 Serveless 生产实例：

- 方法一：在 MO Cloud 实例管理平台的实例列表中，点击您想转换的免费实例的右下角 "**...**">**实例类型转换**，在弹窗中填写或选择付费实例的相关信息然后提交。  
- 方法二：在 MO Cloud 实例管理平台的实例列表中，点击您想转换的免费实例，进入到**概览**页面，点击右上角的**实例类型转换**按钮，在弹窗中填写或选择付费实例的相关信息然后提交。

免费实例转换为付费实例是立即生效的，因此免费的计算和存储资源将不再赠送。而由免费实例转换的付费实例，当月占用免费实例的个数。免费实例转换为付费实例之后，免费 CU 的消耗会被清理掉，您可以在实例详情页面查看这部分 CU 的用量。

##### Serveless 生产实例

如果您想创建 Serveless 生产实例，可以通过线下充值或者使用我们发放的代金券方式为您的平台账户充值，只要账户里有钱就可以创建和使用 Serveless 生产实例。  

选择**生产使用** ，MO Cloud 会为该实例配置独立的、可根据业务需求自动伸缩的计算资源，从而实现近乎极致的性能。此外，您可以配置以下选项：

**消费限制**

- 这一开关可以帮助您更好地管理实例的花费。当实例的计算和存储花费达到您设置的金额限制时，云平台会采取措施限制实例的高性能服务，以控制花费。
- 当开启消费限制功能时，您需要至少配置月消费限制，您也可以同时打开日消费限制，任意限制到达后，都会触发消费限制行为。

**保持服务**

- 一旦消费限制被触发，实例的访问将默认停止。但在某些情况下，您可能希望保持服务的可用性。保持服务功能可以以低性能服务方式继续保持服务，并控制花费。
- 您可以随时修改消费限制功能的设置，包括开关和限制值，以更改实例的花费策略。这些修改将立即生效。

计算资源 - Compute Unit (CU)

Compute Unit (CU) 是 MatrixOne Cloud Serverless 实例的计算资源开销的基本单位，每个 SQL 查询都会消耗一定数量的 CU，其中包括 CPU、内存和 I/O。不同 SQL 查询的 CU 消耗不同，以下是一些示例：

- 查询 10K 行，每行 4 字节：1 CU
- 查询 25K 行，每行 4 字节：3 CU
- 插入 2K 行，每行 4 字节：0.01 CU
- 插入 10K 行，每行 4 字节：0.02 CU
- 更新 1 行，每行 40 字节：1 CU

我们测试了 TPC-H 1GB 数据集的查询 CU 消耗，总计为 1683 CUs。

![](https://community-shared-data-1308875761.cos.ap-beijing.myqcloud.com/artwork/mocdocs/instance-mgmt/tpch-cu.png)

有关 CU 的定价信息，请参考 CU 价格。

#### 步骤三：设置访问控制

##### 管理员密码

在创建 MO Cloud 实例时，您需要设置实例的最高权限管理员（admin）的密码。为了保障数据库的安全性，密码需符合以下规则：

- 至少包含 8 个字符
- 必须包含至少一个数字
- 必须包含至少一个大写字母
- 必须包含至少一个小写字母

##### 网络策略

MatrixOne Cloud 设置了两种网络安全策略

- 允许所有公网 IP 访问  
默认设置为**允许所有公网 IP 访问**
- 允许指定的 IP 访问  
建议设置为**允许指定的 IP 访问**，详情请参考[设置 IP 白名单](../Security/IP-Access.md)章节。  
- 修改网络策略  
在控制台中，选择并点击进入你想要修改的数据库实例，点击进入**网络策略 > 编辑**，在弹框中可切换两种网络策略

#### 步骤四：命名并创建实例

1. 系统将自动为实例分配一个名称，您也可以自定义名称，或者在实例创建完毕后点击实例图标进入概览页面修改实例名称。
2. 在右侧的总览中，您可以查看上述步骤中的实例规划。确认无误后，点击**创建 Serverless 实例**。
3. 实例将在点击创建后的几秒内完成创建。您可以通过监视实例卡片中的实例状态来确认是否创建成功。创建中状态为**创建中**，创建完成状态为**可用**。

### 标准实例

#### 步骤一：选择实例选择公有云服务商及地区

MO Cloud 支持在阿里云创建标准实例。

| 地理区域    | 地区名 | 地点 |
| ----------- | ------ | ---- |
| 亚太 - 中国 | 华东 1 | 杭州 |

#### 步骤二：配置实例容量

- 节点规格

目前 MO Cloud 支持两种节点规格：8 核 32GiB 和 16 核 64GiB，节点数范围为 1-10。您可根据业务需要来选择合适的节点规格。

- 存储

MO Cloud 存储为**按量付费**，根据实际使用量按小时计费。

#### 步骤三：选择付费方式

对于计算资源，MO Cloud 提供了包年包月和按量付费两种付费方式。

- 包年包月

根据需要选择合适的时长，在时长上方会有相应的折扣显示，实例到期前可进行手动续费，剩余天数会显示在实例卡片右上侧。当然您也可以在购买时长下方开启到期自动续费的按钮，续费周期与您当前选择的时长一致，平台将在实例到期前 9 天发起自动扣款，届时请确保账户余额充足。自动续费开启后可随时取消。

- 按量付费

按量付费先使用后收费，平台会每小时对前一小时的消费情况进行扣费。

#### 步骤四：设置访问控制

##### 管理员密码

在创建 MO Cloud 实例时，您需要设置实例的最高权限管理员（admin）的密码。为了保障数据库的安全性，密码需符合以下规则：

- 至少包含 8 个字符
- 必须包含至少一个数字
- 必须包含至少一个大写字母
- 必须包含至少一个小写字母

##### 网络策略

MatrixOne Cloud 设置了两种网络安全策略

- 允许所有公网 IP 访问  
默认设置为**允许所有公网 IP 访问**
- 允许指定的 IP 访问  
建议设置为**允许指定的 IP 访问**，详情请参考[设置 IP 白名单](../Security/IP-Access.md)章节。  
- 修改网络策略  
在控制台中，选择并点击进入你想要修改的数据库实例，点击进入**网络策略 > 编辑**，在弹框中可切换两种网络策略

#### 步骤五：命名并创建实例

1. 系统将自动为实例分配一个名称，您也可以自定义名称，或者在实例创建完毕后点击实例图标进入概览页面修改实例名称。
2. 在右侧的概览中，您可以查看上述步骤中的实例规划。确认无误后，点击右侧**确认下单**。
3. 在支付页面会显示您实例配置的详情和付费方式，我们默认优先扣除代金券余额，您也可以选择自定义组合付费方式，但对于自动续费的金额不支持自定义付款方式。届时请确保您的账户有充足的余额，否则将无法进行下一步。
4. 实例将在点击创建后的几秒内完成创建。您可以通过监视实例卡片中的实例状态来确认是否创建成功。创建中状态为**创建中**，创建完成状态为**可用**。

!!! note
    除下单页面显示的费用外，存储空间费用、以及使用 SQL 造成的对象存储数据请求费用和公网流量费用会每小时按实际用量扣费。详情请参考[价格明细](../Charging/price-detail.md)

## 获取 MO 实例的连接命令

在 MO Cloud 实例管理平台的实例列表中，找到需要访问的 MatrixOne 实例，依次点击**连接 > 通过第三方工具连接**。

此时页面右侧弹出连接实例的命令窗口，SQL Client 下方选择客户端，复制下方的命令即可。

希望这些步骤有助于您成功创建 MatrixOne 实例！如果您需要更多帮助，请继续查看我们的文档或联系支持团队。
